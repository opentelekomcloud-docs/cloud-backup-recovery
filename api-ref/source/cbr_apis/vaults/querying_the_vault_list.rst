:original_name: ListVault.html

.. _ListVault:

Querying the Vault List
=======================

Function
--------

This API is used to query the vault list.

URI
---

GET /v3/{project_id}/vaults

.. table:: **Table 1** Path Parameters

   ========== ========= ====== ===========
   Parameter  Mandatory Type   Description
   ========== ========= ====== ===========
   project_id Yes       String Project ID
   ========== ========= ====== ===========

.. table:: **Table 2** Query Parameters

   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------+
   | Parameter       | Mandatory       | Type            | Description                                                                 |
   +=================+=================+=================+=============================================================================+
   | cloud_type      | No              | String          | Cloud type, which is **public**                                             |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------+
   | id              | No              | String          | Vault ID                                                                    |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------+
   | limit           | No              | Integer         | Number of records displayed per page. The value must be a positive integer. |
   |                 |                 |                 |                                                                             |
   |                 |                 |                 | Minimum: **1**                                                              |
   |                 |                 |                 |                                                                             |
   |                 |                 |                 | Maximum: **1000**                                                           |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------+
   | name            | No              | String          | Vault name                                                                  |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------+
   | object_type     | No              | String          | Object type, which can be **server** or **disk**                            |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------+
   | offset          | No              | Integer         | Offset value. The value must be a positive integer.                         |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------+
   | policy_id       | No              | String          | Policy ID                                                                   |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------+
   | protect_type    | No              | String          | Protection type, which is **backup**                                        |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------+
   | resource_ids    | No              | String          | Resource ID                                                                 |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------+
   | status          | No              | String          | Status                                                                      |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------+

Request Parameters
------------------

.. table:: **Table 3** Request header parameters

   +--------------+-----------+--------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter    | Mandatory | Type   | Description                                                                                                                                                         |
   +==============+===========+========+=====================================================================================================================================================================+
   | X-Auth-Token | No        | String | User token The token can be obtained by calling the IAM API used to obtain a user token. The value of **X-Subject-Token** in the response header is the user token. |
   +--------------+-----------+--------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 4** Response body parameters

   +-----------------------+-----------------------------------------------------------+------------------------------------------+
   | Parameter             | Type                                                      | Description                              |
   +=======================+===========================================================+==========================================+
   | vaults                | Array of :ref:`Vault <listvault__response_vault>` objects | Vault instance list                      |
   +-----------------------+-----------------------------------------------------------+------------------------------------------+
   | count                 | Integer                                                   | Number of vaults                         |
   +-----------------------+-----------------------------------------------------------+------------------------------------------+
   | limit                 | Integer                                                   | Number of records displayed on each page |
   |                       |                                                           |                                          |
   |                       |                                                           | Minimum: **1**                           |
   |                       |                                                           |                                          |
   |                       |                                                           | Maximum: **1000**                        |
   |                       |                                                           |                                          |
   |                       |                                                           | Default: **1000**                        |
   +-----------------------+-----------------------------------------------------------+------------------------------------------+
   | offset                | Integer                                                   | Offset where the query starts            |
   |                       |                                                           |                                          |
   |                       |                                                           | Minimum: **0**                           |
   |                       |                                                           |                                          |
   |                       |                                                           | Default: **0**                           |
   +-----------------------+-----------------------------------------------------------+------------------------------------------+

.. _listvault__response_vault:

.. table:: **Table 5** Vault

   +-----------------------+-------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+
   | Parameter             | Type                                                                    | Description                                                                                       |
   +=======================+=========================================================================+===================================================================================================+
   | billing               | :ref:`Billing <listvault__response_billing>` object                     | Operation info                                                                                    |
   +-----------------------+-------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+
   | description           | String                                                                  | User-defined vault description                                                                    |
   |                       |                                                                         |                                                                                                   |
   |                       |                                                                         | Minimum: **0**                                                                                    |
   |                       |                                                                         |                                                                                                   |
   |                       |                                                                         | Maximum: **255**                                                                                  |
   +-----------------------+-------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+
   | id                    | String                                                                  | Vault ID                                                                                          |
   +-----------------------+-------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+
   | name                  | String                                                                  | Vault name                                                                                        |
   |                       |                                                                         |                                                                                                   |
   |                       |                                                                         | Minimum: **1**                                                                                    |
   |                       |                                                                         |                                                                                                   |
   |                       |                                                                         | Maximum: **64**                                                                                   |
   +-----------------------+-------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+
   | project_id            | String                                                                  | Project ID                                                                                        |
   +-----------------------+-------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+
   | provider_id           | String                                                                  | ID of the vault resource type                                                                     |
   +-----------------------+-------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+
   | resources             | Array of :ref:`ResourceResp <listvault__response_resourceresp>` objects | Vault resources                                                                                   |
   +-----------------------+-------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+
   | tags                  | Array of :ref:`Tag <listvault__response_tag>` objects                   | Vault tags                                                                                        |
   +-----------------------+-------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+
   | auto_bind             | Boolean                                                                 | Indicates whether automatic association is enabled. Its default value is **false** (not enabled). |
   +-----------------------+-------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+
   | bind_rules            | :ref:`VaultBindRules <listvault__response_vaultbindrules>` object       | Association rule                                                                                  |
   +-----------------------+-------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+
   | user_id               | String                                                                  | User ID                                                                                           |
   +-----------------------+-------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+
   | created_at            | String                                                                  | Creation time, for example, **2020-02-05T10:38:34.209782**                                        |
   +-----------------------+-------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+
   | auto_expand           | Boolean                                                                 | Whether to enable auto capacity expansion for the vault.                                          |
   +-----------------------+-------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+

.. _listvault__response_billing:

.. table:: **Table 6** Billing

   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                                                                                                                        |
   +=======================+=======================+====================================================================================================================================================================================+
   | allocated             | Integer               | Allocated capacity, in GB.                                                                                                                                                         |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | charging_mode         | String                | Billing mode, which is **post_paid**                                                                                                                                               |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | cloud_type            | String                | Cloud type, which is **public**                                                                                                                                                    |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | consistent_level      | String                | Vault specification, which is **crash_consistent** by default (crash consistent backup)                                                                                            |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | object_type           | String                | Object type, which can be **server**, **disk**, or **turbo**                                                                                                                       |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | order_id              | String                | Order ID                                                                                                                                                                           |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | product_id            | String                | Product ID                                                                                                                                                                         |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | protect_type          | String                | Protection type, which can be **backup** or **replication**                                                                                                                        |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | size                  | Integer               | Capacity, in GB                                                                                                                                                                    |
   |                       |                       |                                                                                                                                                                                    |
   |                       |                       | Minimum: **1**                                                                                                                                                                     |
   |                       |                       |                                                                                                                                                                                    |
   |                       |                       | Maximum: **10485760**                                                                                                                                                              |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | spec_code             | String                | Specification code Server backup vault: **vault.backup.server.normal**; Disk backup vault: **vault.backup.volume.normal**; File system backup vault: **vault.backup.turbo.normal** |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | status                | String                | Vault status                                                                                                                                                                       |
   |                       |                       |                                                                                                                                                                                    |
   |                       |                       | Enumeration values:                                                                                                                                                                |
   |                       |                       |                                                                                                                                                                                    |
   |                       |                       | -  **available**                                                                                                                                                                   |
   |                       |                       |                                                                                                                                                                                    |
   |                       |                       | -  **lock**                                                                                                                                                                        |
   |                       |                       |                                                                                                                                                                                    |
   |                       |                       | -  **frozen**                                                                                                                                                                      |
   |                       |                       |                                                                                                                                                                                    |
   |                       |                       | -  **deleting**                                                                                                                                                                    |
   |                       |                       |                                                                                                                                                                                    |
   |                       |                       | -  **error**                                                                                                                                                                       |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | storage_unit          | String                | Name of the bucket for the vault                                                                                                                                                   |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | used                  | Integer               | Used capacity, in MB.                                                                                                                                                              |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | frozen_scene          | String                | Scenario when an account is frozen                                                                                                                                                 |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _listvault__response_resourceresp:

.. table:: **Table 7** ResourceResp

   +-----------------------+-------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Type                                                                    | Description                                                                                                            |
   +=======================+=========================================================================+========================================================================================================================+
   | extra_info            | :ref:`ResourceExtraInfo <listvault__response_resourceextrainfo>` object | Additional information of the resource                                                                                 |
   +-----------------------+-------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
   | id                    | String                                                                  | ID of the resource to be backed up                                                                                     |
   +-----------------------+-------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
   | name                  | String                                                                  | Name of the resource to be backed up                                                                                   |
   |                       |                                                                         |                                                                                                                        |
   |                       |                                                                         | Minimum: **0**                                                                                                         |
   |                       |                                                                         |                                                                                                                        |
   |                       |                                                                         | Maximum: **255**                                                                                                       |
   +-----------------------+-------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
   | protect_status        | String                                                                  | Protection status                                                                                                      |
   |                       |                                                                         |                                                                                                                        |
   |                       |                                                                         | Enumeration values:                                                                                                    |
   |                       |                                                                         |                                                                                                                        |
   |                       |                                                                         | -  **available**                                                                                                       |
   |                       |                                                                         |                                                                                                                        |
   |                       |                                                                         | -  **error**                                                                                                           |
   |                       |                                                                         |                                                                                                                        |
   |                       |                                                                         | -  **protecting**                                                                                                      |
   |                       |                                                                         |                                                                                                                        |
   |                       |                                                                         | -  **restoring**                                                                                                       |
   |                       |                                                                         |                                                                                                                        |
   |                       |                                                                         | -  **removing**                                                                                                        |
   +-----------------------+-------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
   | size                  | Integer                                                                 | Allocated capacity for the associated resources, in GB                                                                 |
   +-----------------------+-------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
   | type                  | String                                                                  | Type of the resource to be backed up, which can be **OS::Nova::Server**, **OS::Cinder::Volume**, or **OS::Sfs::Turbo** |
   +-----------------------+-------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
   | backup_size           | Integer                                                                 | Backup size                                                                                                            |
   +-----------------------+-------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
   | backup_count          | Integer                                                                 | Number of backups                                                                                                      |
   +-----------------------+-------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+

.. _listvault__response_resourceextrainfo:

.. table:: **Table 8** ResourceExtraInfo

   +-----------------+------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Type             | Description                                                                                                                                                                                                                                                                                 |
   +=================+==================+=============================================================================================================================================================================================================================================================================================+
   | exclude_volumes | Array of strings | IDs of the disks that will not be backed up. This parameter is used when servers are added to a vault, which include all server disks. But some disks do not need to be backed up. Or in case that a server was previously added and some disks on this server do not need to be backed up. |
   +-----------------+------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _listvault__response_tag:

.. table:: **Table 9** Tag

   +-----------------------+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                                                                                                                                                     |
   +=======================+=======================+=================================================================================================================================================================================================================+
   | key                   | String                | Key                                                                                                                                                                                                             |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | It can contain a maximum of 36 characters.                                                                                                                                                                      |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | It cannot be an empty string.                                                                                                                                                                                   |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | Spaces before and after a key will be discarded.                                                                                                                                                                |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | It cannot contain the following characters: ASCII (0-31), equal signs (=), asterisks (``*``), left angle brackets (<), right angle brackets (>), backslashes (), commas (,), vertical bars (|), and slashes (/) |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | It can contain only letters, digits, hyphens (-), and underscores (_).                                                                                                                                          |
   +-----------------------+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | value                 | String                | Value                                                                                                                                                                                                           |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | It is mandatory when a tag is added and optional when a tag is deleted.                                                                                                                                         |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | It can contain a maximum of 43 characters.                                                                                                                                                                      |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | It can be an empty string.                                                                                                                                                                                      |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | Spaces before and after a value will be discarded.                                                                                                                                                              |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | It cannot contain the following characters: ASCII (0-31), equal signs (=), asterisks (``*``), left angle brackets (<), right angle brackets (>), backslashes (), commas (,), vertical bars (|), and slashes (/) |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | It can contain only letters, digits, hyphens (-), and underscores (_).                                                                                                                                          |
   +-----------------------+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _listvault__response_vaultbindrules:

.. table:: **Table 10** VaultBindRules

   +-----------+---------------------------------------------------------------------------+----------------------------------------------------+
   | Parameter | Type                                                                      | Description                                        |
   +===========+===========================================================================+====================================================+
   | tags      | Array of :ref:`BindRulesTags <listvault__response_bindrulestags>` objects | Filters automatically associated resources by tag. |
   +-----------+---------------------------------------------------------------------------+----------------------------------------------------+

.. _listvault__response_bindrulestags:

.. table:: **Table 11** BindRulesTags

   +-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                                            |
   +=======================+=======================+========================================================================================================+
   | key                   | String                | The key cannot contain non-printable ASCII characters (0-31) and the following characters:``=*<>\,|/`` |
   |                       |                       |                                                                                                        |
   |                       |                       | The key can contain only letters, digits, underscores (_), and hyphens (-).                            |
   +-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
   | value                 | String                | The value cannot contain non-printable ASCII characters (0-31) and the following characters: =*<>,|/   |
   |                       |                       |                                                                                                        |
   |                       |                       | The value can contain only letters, digits, underscores (_), and hyphens (-).                          |
   +-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------+

Example Requests
----------------

.. code-block:: text

   GET  https://{endpoint}/v3/{project_id}/vaults

Example Responses
-----------------

**Status code: 200**

OK

.. code-block::

   {
     "vaults" : [ {
       "id" : "a335f9e1-1628-4c64-a7be-38656e5ec19c",
       "name" : "vault-8538",
       "resources" : [ ],
       "provider_id" : "0daac4c5-6707-4851-97ba-169e36266b66",
       "created_at" : "2020-09-04T06:57:37.344+00:00",
       "project_id" : "0605767b5780d5762fc5c0118072a564",
       "enterprise_project_id" : 0,
       "auto_bind" : false,
       "bind_rules" : { },
       "auto_expand" : false,
       "user_id" : "aa2999fa5ae640f28926f8fd79188934",
       "billing" : {
         "allocated" : 0,
         "cloud_type" : "public",
         "consistent_level" : "crash_consistent",
         "charging_mode" : "post_paid",
         "protect_type" : "backup",
         "object_type" : "server",
         "spec_code" : "vault.backup.server.normal",
         "used" : 0,
         "status" : "available",
         "size" : 100
       },
       "tags" : [ ]
     } ],
     "count" : 50
   }

Status Codes
------------

=========== ===========
Status Code Description
=========== ===========
200         OK
=========== ===========

Error Codes
-----------

See :ref:`Error Codes <errorcode>`.
