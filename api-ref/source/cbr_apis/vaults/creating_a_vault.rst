:original_name: CreateVault.html

.. _CreateVault:

Creating a Vault
================

Function
--------

This API is used to create a vault.

URI
---

POST /v3/{project_id}/vaults

.. table:: **Table 1** Path Parameters

   ========== ========= ====== ===========
   Parameter  Mandatory Type   Description
   ========== ========= ====== ===========
   project_id Yes       String Project ID
   ========== ========= ====== ===========

Request Parameters
------------------

.. table:: **Table 2** Request header parameters

   +--------------+-----------+--------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter    | Mandatory | Type   | Description                                                                                                                                                         |
   +==============+===========+========+=====================================================================================================================================================================+
   | X-Auth-Token | Yes       | String | User token The token can be obtained by calling the IAM API used to obtain a user token. The value of **X-Subject-Token** in the response header is the user token. |
   +--------------+-----------+--------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. table:: **Table 3** Request body parameters

   +-----------+-----------+--------------------------------------------------------------+---------------------------------+
   | Parameter | Mandatory | Type                                                         | Description                     |
   +===========+===========+==============================================================+=================================+
   | vault     | Yes       | :ref:`VaultCreate <createvault__request_vaultcreate>` object | Parameters for creating a vault |
   +-----------+-----------+--------------------------------------------------------------+---------------------------------+

.. _createvault__request_vaultcreate:

.. table:: **Table 4** VaultCreate

   +------------------+-----------------+------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+
   | Parameter        | Mandatory       | Type                                                                         | Description                                                                                                       |
   +==================+=================+==============================================================================+===================================================================================================================+
   | backup_policy_id | No              | String                                                                       | Backup policy ID. If the value of this parameter is null, automatic backup is not performed.                      |
   +------------------+-----------------+------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+
   | billing          | Yes             | :ref:`BillingCreate <createvault__request_billingcreate>` object             | Parameter information for creation                                                                                |
   +------------------+-----------------+------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+
   | description      | No              | String                                                                       | User-defined vault description                                                                                    |
   |                  |                 |                                                                              |                                                                                                                   |
   |                  |                 |                                                                              | Minimum: **0**                                                                                                    |
   |                  |                 |                                                                              |                                                                                                                   |
   |                  |                 |                                                                              | Maximum: **64**                                                                                                   |
   +------------------+-----------------+------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+
   | name             | Yes             | String                                                                       | Vault name                                                                                                        |
   |                  |                 |                                                                              |                                                                                                                   |
   |                  |                 |                                                                              | Minimum: **1**                                                                                                    |
   |                  |                 |                                                                              |                                                                                                                   |
   |                  |                 |                                                                              | Maximum: **64**                                                                                                   |
   +------------------+-----------------+------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+
   | resources        | Yes             | Array of :ref:`ResourceCreate <createvault__request_resourcecreate>` objects | Associated resources. Set this parameter to **[]** if no resources are associated when creating a vault.          |
   |                  |                 |                                                                              |                                                                                                                   |
   |                  |                 |                                                                              | Array Length: **0 - 255**                                                                                         |
   +------------------+-----------------+------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+
   | tags             | No              | Array of :ref:`Tag <createvault__request_tag>` objects                       | Tag list This list cannot be an empty list. The list can contain up to 20 keys. Keys in this list must be unique. |
   +------------------+-----------------+------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+
   | auto_bind        | No              | Boolean                                                                      | Whether automatic association is supported                                                                        |
   +------------------+-----------------+------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+
   | bind_rules       | No              | :ref:`VaultBindRules <createvault__request_vaultbindrules>` object           | Rules for automatic association                                                                                   |
   +------------------+-----------------+------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+

.. _createvault__request_billingcreate:

.. table:: **Table 5** BillingCreate

   +------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter        | Mandatory       | Type            | Description                                                                                                                                                   |
   +==================+=================+=================+===============================================================================================================================================================+
   | cloud_type       | No              | String          | Cloud type, which is **public**                                                                                                                               |
   +------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | consistent_level | Yes             | String          | Vault specification, which is **crash_consistent** by default (crash consistent backup)                                                                       |
   +------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | object_type      | Yes             | String          | Object type, which can be **server**, **disk**, or **turbo**                                                                                                  |
   +------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | protect_type     | Yes             | String          | Protection type, which is backup                                                                                                                              |
   +------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | size             | Yes             | Integer         | Capacity, in GB                                                                                                                                               |
   |                  |                 |                 |                                                                                                                                                               |
   |                  |                 |                 | Minimum: **10**                                                                                                                                               |
   |                  |                 |                 |                                                                                                                                                               |
   |                  |                 |                 | Maximum: **10485760**                                                                                                                                         |
   +------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | charging_mode    | No              | String          | Billing mode, which is **post_paid**                                                                                                                          |
   |                  |                 |                 |                                                                                                                                                               |
   |                  |                 |                 | Default: **post_paid**                                                                                                                                        |
   +------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | is_auto_renew    | No              | Boolean         | Whether to automatically renew the subscription after expiration. By default, it is not renewed.                                                              |
   |                  |                 |                 |                                                                                                                                                               |
   |                  |                 |                 | Default: **false**                                                                                                                                            |
   +------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | is_auto_pay      | No              | Boolean         | Whether the fee is automatically deducted from the customer's account balance after an order is submitted. The non-automatic payment mode is used by default. |
   |                  |                 |                 |                                                                                                                                                               |
   |                  |                 |                 | Default: **false**                                                                                                                                            |
   +------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | console_url      | No              | String          | Redirection URL                                                                                                                                               |
   |                  |                 |                 |                                                                                                                                                               |
   |                  |                 |                 | Minimum: **1**                                                                                                                                                |
   |                  |                 |                 |                                                                                                                                                               |
   |                  |                 |                 | Maximum: **255**                                                                                                                                              |
   +------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _createvault__request_resourcecreate:

.. table:: **Table 6** ResourceCreate

   +-----------------+-----------------+--------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Mandatory       | Type                                                                     | Description                                                                                                            |
   +=================+=================+==========================================================================+========================================================================================================================+
   | extra_info      | No              | :ref:`ResourceExtraInfo <createvault__request_resourceextrainfo>` object | Additional information of the resource                                                                                 |
   +-----------------+-----------------+--------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
   | id              | Yes             | String                                                                   | ID of the resource to be backed up                                                                                     |
   +-----------------+-----------------+--------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
   | type            | Yes             | String                                                                   | Type of the resource to be backed up, which can be **OS::Nova::Server**, **OS::Cinder::Volume**, or **OS::Sfs::Turbo** |
   +-----------------+-----------------+--------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
   | name            | No              | String                                                                   | Resource name                                                                                                          |
   |                 |                 |                                                                          |                                                                                                                        |
   |                 |                 |                                                                          | Minimum: **0**                                                                                                         |
   |                 |                 |                                                                          |                                                                                                                        |
   |                 |                 |                                                                          | Maximum: **255**                                                                                                       |
   +-----------------+-----------------+--------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+

.. _createvault__request_resourceextrainfo:

.. table:: **Table 7** ResourceExtraInfo

   +-----------------+-----------+------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Mandatory | Type             | Description                                                                                                                                                                                                                                                                                 |
   +=================+===========+==================+=============================================================================================================================================================================================================================================================================================+
   | exclude_volumes | No        | Array of strings | IDs of the disks that will not be backed up. This parameter is used when servers are added to a vault, which include all server disks. But some disks do not need to be backed up. Or in case that a server was previously added and some disks on this server do not need to be backed up. |
   +-----------------+-----------+------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _createvault__request_tag:

.. table:: **Table 8** Tag

   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Mandatory       | Type            | Description                                                                                                                                                                                                     |
   +=================+=================+=================+=================================================================================================================================================================================================================+
   | key             | Yes             | String          | Key                                                                                                                                                                                                             |
   |                 |                 |                 |                                                                                                                                                                                                                 |
   |                 |                 |                 | It can contain a maximum of 36 characters.                                                                                                                                                                      |
   |                 |                 |                 |                                                                                                                                                                                                                 |
   |                 |                 |                 | It cannot be an empty string.                                                                                                                                                                                   |
   |                 |                 |                 |                                                                                                                                                                                                                 |
   |                 |                 |                 | Spaces before and after a key will be discarded.                                                                                                                                                                |
   |                 |                 |                 |                                                                                                                                                                                                                 |
   |                 |                 |                 | It cannot contain the following characters: ASCII (0-31), equal signs (=), asterisks (``*``), left angle brackets (<), right angle brackets (>), backslashes (), commas (,), vertical bars (|), and slashes (/) |
   |                 |                 |                 |                                                                                                                                                                                                                 |
   |                 |                 |                 | It can contain only letters, digits, hyphens (-), and underscores (_).                                                                                                                                          |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | value           | No              | String          | Value                                                                                                                                                                                                           |
   |                 |                 |                 |                                                                                                                                                                                                                 |
   |                 |                 |                 | It is mandatory when a tag is added and optional when a tag is deleted.                                                                                                                                         |
   |                 |                 |                 |                                                                                                                                                                                                                 |
   |                 |                 |                 | It can contain a maximum of 43 characters.                                                                                                                                                                      |
   |                 |                 |                 |                                                                                                                                                                                                                 |
   |                 |                 |                 | It can be an empty string.                                                                                                                                                                                      |
   |                 |                 |                 |                                                                                                                                                                                                                 |
   |                 |                 |                 | Spaces before and after a value will be discarded.                                                                                                                                                              |
   |                 |                 |                 |                                                                                                                                                                                                                 |
   |                 |                 |                 | It cannot contain the following characters: ASCII (0-31), equal signs (=), asterisks (``*``), left angle brackets (<), right angle brackets (>), backslashes (), commas (,), vertical bars (|), and slashes (/) |
   |                 |                 |                 |                                                                                                                                                                                                                 |
   |                 |                 |                 | It can contain only letters, digits, hyphens (-), and underscores (_).                                                                                                                                          |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _createvault__request_vaultbindrules:

.. table:: **Table 9** VaultBindRules

   +-----------+-----------+----------------------------------------------------------------------------+----------------------------------------------------+
   | Parameter | Mandatory | Type                                                                       | Description                                        |
   +===========+===========+============================================================================+====================================================+
   | tags      | No        | Array of :ref:`BindRulesTags <createvault__request_bindrulestags>` objects | Filters automatically associated resources by tag. |
   +-----------+-----------+----------------------------------------------------------------------------+----------------------------------------------------+

.. _createvault__request_bindrulestags:

.. table:: **Table 10** BindRulesTags

   +-----------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------+
   | Parameter       | Mandatory       | Type            | Description                                                                                             |
   +=================+=================+=================+=========================================================================================================+
   | key             | Yes             | String          | The key cannot contain non-printable ASCII characters (0-31) and the following characters: ``=*<>\,|/`` |
   |                 |                 |                 |                                                                                                         |
   |                 |                 |                 | The key can contain only letters, digits, underscores (_), and hyphens (-).                             |
   +-----------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------+
   | value           | No              | String          | The value cannot contain non-printable ASCII characters (0-31) and the following characters: =*<>,|/    |
   |                 |                 |                 |                                                                                                         |
   |                 |                 |                 | The value can contain only letters, digits, underscores (_), and hyphens (-).                           |
   +-----------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------+

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 11** Response body parameters

   +-----------+-------------------------------------------------------------------------------+--------------------------------------+
   | Parameter | Type                                                                          | Description                          |
   +===========+===============================================================================+======================================+
   | vault     | :ref:`VaultCreateResource <createvault__response_vaultcreateresource>` object | Objects returned after a vault query |
   +-----------+-------------------------------------------------------------------------------+--------------------------------------+

.. _createvault__response_vaultcreateresource:

.. table:: **Table 12** VaultCreateResource

   +-----------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------------------+
   | Parameter             | Type                                                                      | Description                                                                           |
   +=======================+===========================================================================+=======================================================================================+
   | billing               | :ref:`Billing <createvault__response_billing>` object                     | Operations information                                                                |
   +-----------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------------------+
   | description           | String                                                                    | User-defined vault description                                                        |
   |                       |                                                                           |                                                                                       |
   |                       |                                                                           | Minimum: **0**                                                                        |
   |                       |                                                                           |                                                                                       |
   |                       |                                                                           | Maximum: **255**                                                                      |
   +-----------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------------------+
   | id                    | String                                                                    | Vault ID                                                                              |
   +-----------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------------------+
   | name                  | String                                                                    | Vault name                                                                            |
   |                       |                                                                           |                                                                                       |
   |                       |                                                                           | Minimum: **1**                                                                        |
   |                       |                                                                           |                                                                                       |
   |                       |                                                                           | Maximum: **64**                                                                       |
   +-----------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------------------+
   | project_id            | String                                                                    | Project ID                                                                            |
   +-----------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------------------+
   | provider_id           | String                                                                    | ID of the vault resource type                                                         |
   +-----------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------------------+
   | resources             | Array of :ref:`ResourceResp <createvault__response_resourceresp>` objects | Vault resources                                                                       |
   +-----------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------------------+
   | tags                  | Array of :ref:`Tag <createvault__response_tag>` objects                   | Vault tags                                                                            |
   +-----------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------------------+
   | auto_bind             | Boolean                                                                   | Whether to enable automatic association. Its default value is **false** (not enable). |
   +-----------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------------------+
   | bind_rules            | :ref:`VaultBindRules <createvault__response_vaultbindrules>` object       | Association rules                                                                     |
   +-----------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------------------+
   | user_id               | String                                                                    | User ID                                                                               |
   +-----------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------------------+
   | created_at            | String                                                                    | Creation time, for example, **2020-02-05T10:38:34.209782**                            |
   +-----------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------------------+
   | auto_expand           | Boolean                                                                   | Whether to enable auto capacity expansion for the vault.                              |
   +-----------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------------------+

.. _createvault__response_billing:

.. table:: **Table 13** Billing

   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                                                                                                                        |
   +=======================+=======================+====================================================================================================================================================================================+
   | allocated             | Integer               | Allocated capacity, in GB.                                                                                                                                                         |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | charging_mode         | String                | Billing mode, which is **post_paid**                                                                                                                                               |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | cloud_type            | String                | Cloud type, which is **public**                                                                                                                                                    |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | consistent_level      | String                | Vault specification, which is **crash_consistent** by default (crash consistent backup)                                                                                            |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | object_type           | String                | Object type, which can be **server**, **disk**, or **turbo**                                                                                                                       |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | order_id              | String                | Order ID                                                                                                                                                                           |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | product_id            | String                | Product ID                                                                                                                                                                         |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | protect_type          | String                | Protection type, which is **backup**                                                                                                                                               |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | size                  | Integer               | Capacity, in GB                                                                                                                                                                    |
   |                       |                       |                                                                                                                                                                                    |
   |                       |                       | Minimum: **1**                                                                                                                                                                     |
   |                       |                       |                                                                                                                                                                                    |
   |                       |                       | Maximum: **10485760**                                                                                                                                                              |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | spec_code             | String                | Specification code Server backup vault: **vault.backup.server.normal**; Disk backup vault: **vault.backup.volume.normal**; File system backup vault: **vault.backup.turbo.normal** |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | status                | String                | Vault status                                                                                                                                                                       |
   |                       |                       |                                                                                                                                                                                    |
   |                       |                       | Enumeration values:                                                                                                                                                                |
   |                       |                       |                                                                                                                                                                                    |
   |                       |                       | -  **available**                                                                                                                                                                   |
   |                       |                       | -  **lock**                                                                                                                                                                        |
   |                       |                       | -  **frozen**                                                                                                                                                                      |
   |                       |                       | -  **deleting**                                                                                                                                                                    |
   |                       |                       | -  **error**                                                                                                                                                                       |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | storage_unit          | String                | Name of the bucket for the vault                                                                                                                                                   |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | used                  | Integer               | Used capacity, in MB.                                                                                                                                                              |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | frozen_scene          | String                | Scenario when an account is frozen                                                                                                                                                 |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _createvault__response_resourceresp:

.. table:: **Table 14** ResourceResp

   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Type                                                                      | Description                                                                                                            |
   +=======================+===========================================================================+========================================================================================================================+
   | extra_info            | :ref:`ResourceExtraInfo <createvault__response_resourceextrainfo>` object | Additional information of the resource                                                                                 |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
   | id                    | String                                                                    | ID of the resource to be backed up                                                                                     |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
   | name                  | String                                                                    | Name of the resource to be backed up                                                                                   |
   |                       |                                                                           |                                                                                                                        |
   |                       |                                                                           | Minimum: **0**                                                                                                         |
   |                       |                                                                           |                                                                                                                        |
   |                       |                                                                           | Maximum: **255**                                                                                                       |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
   | protect_status        | String                                                                    | Protection status                                                                                                      |
   |                       |                                                                           |                                                                                                                        |
   |                       |                                                                           | Enumeration values:                                                                                                    |
   |                       |                                                                           |                                                                                                                        |
   |                       |                                                                           | -  **available**                                                                                                       |
   |                       |                                                                           | -  **error**                                                                                                           |
   |                       |                                                                           | -  **protecting**                                                                                                      |
   |                       |                                                                           | -  **restoring**                                                                                                       |
   |                       |                                                                           | -  **removing**                                                                                                        |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
   | size                  | Integer                                                                   | Allocated capacity for the associated resources, in GB                                                                 |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
   | type                  | String                                                                    | Type of the resource to be backed up, which can be **OS::Nova::Server**, **OS::Cinder::Volume**, or **OS::Sfs::Turbo** |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
   | backup_size           | Integer                                                                   | Backup size                                                                                                            |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
   | backup_count          | Integer                                                                   | Number of backups                                                                                                      |
   +-----------------------+---------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+

.. _createvault__response_resourceextrainfo:

.. table:: **Table 15** ResourceExtraInfo

   +-----------------+------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Type             | Description                                                                                                                                                                                                                                                                                 |
   +=================+==================+=============================================================================================================================================================================================================================================================================================+
   | exclude_volumes | Array of strings | IDs of the disks that will not be backed up. This parameter is used when servers are added to a vault, which include all server disks. But some disks do not need to be backed up. Or in case that a server was previously added and some disks on this server do not need to be backed up. |
   +-----------------+------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _createvault__response_tag:

.. table:: **Table 16** Tag

   +-----------------------+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                                                                                                                                                     |
   +=======================+=======================+=================================================================================================================================================================================================================+
   | key                   | String                | Key                                                                                                                                                                                                             |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | It can contain a maximum of 36 characters.                                                                                                                                                                      |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | It cannot be an empty string.                                                                                                                                                                                   |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | Spaces before and after a key will be discarded.                                                                                                                                                                |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | It cannot contain the following characters: ASCII (0-31), equal signs (=), asterisks (``*``), left angle brackets (<), right angle brackets (>), backslashes (), commas (,), vertical bars (|), and slashes (/) |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | It can contain only letters, digits, hyphens (-), and underscores (_).                                                                                                                                          |
   +-----------------------+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | value                 | String                | Value                                                                                                                                                                                                           |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | It is mandatory when a tag is added and optional when a tag is deleted.                                                                                                                                         |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | It can contain a maximum of 43 characters.                                                                                                                                                                      |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | It can be an empty string.                                                                                                                                                                                      |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | Spaces before and after a value will be discarded.                                                                                                                                                              |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | It cannot contain the following characters: ASCII (0-31), equal signs (=), asterisks (``*``), left angle brackets (<), right angle brackets (>), backslashes (), commas (,), vertical bars (|), and slashes (/) |
   |                       |                       |                                                                                                                                                                                                                 |
   |                       |                       | It can contain only letters, digits, hyphens (-), and underscores (_).                                                                                                                                          |
   +-----------------------+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _createvault__response_vaultbindrules:

.. table:: **Table 17** VaultBindRules

   +-----------+-----------------------------------------------------------------------------+----------------------------------------------------+
   | Parameter | Type                                                                        | Description                                        |
   +===========+=============================================================================+====================================================+
   | tags      | Array of :ref:`BindRulesTags <createvault__response_bindrulestags>` objects | Filters automatically associated resources by tag. |
   +-----------+-----------------------------------------------------------------------------+----------------------------------------------------+

.. _createvault__response_bindrulestags:

.. table:: **Table 18** BindRulesTags

   +-----------------------+-----------------------+---------------------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                                             |
   +=======================+=======================+=========================================================================================================+
   | key                   | String                | The key cannot contain non-printable ASCII characters (0-31) and the following characters: ``=*<>\,|/`` |
   |                       |                       |                                                                                                         |
   |                       |                       | The key can contain only letters, digits, underscores (_), and hyphens (-).                             |
   +-----------------------+-----------------------+---------------------------------------------------------------------------------------------------------+
   | value                 | String                | The value cannot contain non-printable ASCII characters (0-31) and the following characters: =*<>,|/    |
   |                       |                       |                                                                                                         |
   |                       |                       | The value can contain only letters, digits, underscores (_), and hyphens (-).                           |
   +-----------------------+-----------------------+---------------------------------------------------------------------------------------------------------+

**Status code: 400**

.. table:: **Table 19** Response body parameters

   ========== ====== ================================================
   Parameter  Type   Description
   ========== ====== ================================================
   error_code String For details, see :ref:`Error Codes <errorcode>`.
   error_msg  String Error message
   ========== ====== ================================================

Example Requests
----------------

-  Creating a server backup vault, associating resources, and adding tags

   .. code-block:: text

      POST https://{endpoint}/v3/f841e01fd2b14e7fa41b6ae7aa6b0594/vaults

      {
        "vault" : {
          "backup_policy_id" : "6dd81d7d-a4cb-443e-b8ed-1af0bd3a261b",
          "billing" : {
            "cloud_type" : "public",
            "consistent_level" : "crash_consistent",
            "object_type" : "server",
            "protect_type" : "backup",
            "size" : 100,
            "charging_mode" : "post_paid",
            "is_auto_renew" : false,
            "is_auto_pay" : false,
            "console_url" : "https://console.demo.com/cbr/?agencyId=97fcd896b7914cb98f553a087232e243&region=testregion/cbr/manager/csbs/vaultList"
          },
          "description" : "vault_description",
          "name" : "vault_name",
          "resources" : [ {
            "extra_info" : {
              "exclude_volumes" : [ "43a320a5-3efd-4568-b1aa-8dd9183cc64b" ]
            },
            "id" : "23a320a5-3efd-4568-b1aa-8dd9183cc64c",
            "type" : "OS::Nova::Server"
          } ],
          "tags" : [ {
            "key" : "key01",
            "value" : "value01"
          } ],
          "enterprise_project_id" : "0"
        }
      }

-  Creating a disk backup vault (with mandatory parameters only)

   .. code-block::

       POST https://{endpoint}/v3/f841e01fd2b14e7fa41b6ae7aa6b0594/vaults

      {
        "vault" : {
          "billing" : {
            "consistent_level" : "crash_consistent",
            "object_type" : "disk",
            "protect_type" : "backup",
            "size" : 40,
            "charging_mode" : "post_paid",
            "is_auto_renew" : false,
            "is_auto_pay" : false
          },
          "name" : "test",
          "resources" : [ ]
        }
      }

Example Responses
-----------------

**Status code: 200**

OK

.. code-block::

   {
     "vault" : {
       "provider_id" : "0daac4c5-6707-4851-97ba-169e36266b66",
       "description" : "vault_description",
       "tags" : [ {
         "value" : "value01",
         "key" : "key01"
       } ],
       "enterprise_project_id" : "0",
       "auto_bind" : false,
       "id" : "ad7627ae-5b0b-492e-b6bd-cd809b745197",
       "user_id" : "38d65be2ecd840d19046e239e841a734",
       "name" : "vault_name",
       "billing" : {
         "status" : "available",
         "used" : 0,
         "protect_type" : "backup",
         "order_id" : null,
         "object_type" : "server",
         "allocated" : 40,
         "spec_code" : "vault.backup.server.normal",
         "size" : 100,
         "cloud_type" : "public",
         "product_id" : null,
         "consistent_level" : "crash_consistent",
         "storage_unit" : null,
         "charging_mode" : "post_paid"
       },
       "created_at" : "2019-05-23T12:51:10.071232",
       "project_id" : "fc347bc64ccd4589ae52e4f44b7433c7",
       "resources" : [ {
         "name" : "ecs-b977-0002",
         "backup_size" : 0,
         "protect_status" : "available",
         "backup_count" : 0,
         "extra_info" : {
           "exclude_volumes" : [ "1855eb9a-2b5e-4938-a9f0-aea08b6f9243", "5a51e8b3-2f65-4045-896f-f8ffae14b064" ]
         },
         "type" : "OS::Nova::Server",
         "id" : "23a320a5-3efd-4568-b1aa-8dd9183cc64c",
         "size" : 40
       } ]
     }
   }

Status Codes
------------

=========== ===========
Status Code Description
=========== ===========
200         OK
400         Bad Request
=========== ===========

Error Codes
-----------

See :ref:`Error Codes <errorcode>`.
