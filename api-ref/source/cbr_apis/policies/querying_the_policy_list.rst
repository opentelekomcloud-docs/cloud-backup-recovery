:original_name: ListPolicies.html

.. _ListPolicies:

Querying the Policy List
========================

Function
--------

This API is used to query the policy list.

URI
---

GET /v3/{project_id}/policies

.. table:: **Table 1** Path Parameters

   ========== ========= ====== ===========
   Parameter  Mandatory Type   Description
   ========== ========= ====== ===========
   project_id Yes       String Project ID
   ========== ========= ====== ===========

.. table:: **Table 2** Query Parameters

   +-----------------+-----------------+-----------------+---------------------------------------------------------+
   | Parameter       | Mandatory       | Type            | Description                                             |
   +=================+=================+=================+=========================================================+
   | operation_type  | No              | String          | Policy type, which can be **backup** or **replication** |
   |                 |                 |                 |                                                         |
   |                 |                 |                 | Enumeration values:                                     |
   |                 |                 |                 |                                                         |
   |                 |                 |                 | -  **backup**                                           |
   |                 |                 |                 |                                                         |
   |                 |                 |                 | -  **replication**                                      |
   +-----------------+-----------------+-----------------+---------------------------------------------------------+
   | vault_id        | No              | String          | Vault ID                                                |
   +-----------------+-----------------+-----------------+---------------------------------------------------------+

Request Parameters
------------------

.. table:: **Table 3** Request header parameters

   +-----------------+-----------------+-----------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Mandatory       | Type            | Description                                                                                                                                              |
   +=================+=================+=================+==========================================================================================================================================================+
   | X-Auth-Token    | Yes             | String          | User token                                                                                                                                               |
   |                 |                 |                 |                                                                                                                                                          |
   |                 |                 |                 | The token can be obtained by calling the IAM API used to obtain a user token. The value of **X-Subject-Token** in the response header is the user token. |
   +-----------------+-----------------+-----------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 4** Response body parameters

   +-----------+----------------------------------------------------------------+--------------------------+
   | Parameter | Type                                                           | Description              |
   +===========+================================================================+==========================+
   | policies  | Array of :ref:`Policy <listpolicies__response_policy>` objects | Policy list              |
   +-----------+----------------------------------------------------------------+--------------------------+
   | count     | Integer                                                        | Total number of policies |
   +-----------+----------------------------------------------------------------+--------------------------+

.. _listpolicies__response_policy:

.. table:: **Table 5** Policy

   +-----------------------+--------------------------------------------------------------------------------------------+-------------------------------------------------------------+
   | Parameter             | Type                                                                                       | Description                                                 |
   +=======================+============================================================================================+=============================================================+
   | enabled               | Boolean                                                                                    | Whether the policy is enabled                               |
   +-----------------------+--------------------------------------------------------------------------------------------+-------------------------------------------------------------+
   | id                    | String                                                                                     | Policy ID                                                   |
   +-----------------------+--------------------------------------------------------------------------------------------+-------------------------------------------------------------+
   | name                  | String                                                                                     | Policy Name                                                 |
   +-----------------------+--------------------------------------------------------------------------------------------+-------------------------------------------------------------+
   | operation_definition  | :ref:`PolicyoODCreate <listpolicies__response_policyoodcreate>` object                     | Policy attributes                                           |
   +-----------------------+--------------------------------------------------------------------------------------------+-------------------------------------------------------------+
   | operation_type        | String                                                                                     | Protection type, which can be **backup** or **replication** |
   |                       |                                                                                            |                                                             |
   |                       |                                                                                            | Enumeration values:                                         |
   |                       |                                                                                            |                                                             |
   |                       |                                                                                            | -  **backup**                                               |
   |                       |                                                                                            |                                                             |
   |                       |                                                                                            | -  **replication**                                          |
   +-----------------------+--------------------------------------------------------------------------------------------+-------------------------------------------------------------+
   | trigger               | :ref:`PolicyTriggerResp <listpolicies__response_policytriggerresp>` object                 | Time scheduling rule for the policy                         |
   +-----------------------+--------------------------------------------------------------------------------------------+-------------------------------------------------------------+
   | associated_vaults     | Array of :ref:`PolicyAssociateVault <listpolicies__response_policyassociatevault>` objects | Associated vault                                            |
   +-----------------------+--------------------------------------------------------------------------------------------+-------------------------------------------------------------+

.. _listpolicies__response_policyoodcreate:

.. table:: **Table 6** PolicyoODCreate

   +-------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter               | Type                  | Description                                                                                                                                                                                                                                                                                                                                                                                                             |
   +=========================+=======================+=========================================================================================================================================================================================================================================================================================================================================================================================================================+
   | day_backups             | Integer               | Maximum number of daily backups that can be retained. The latest backup of each day is saved in the long term. This parameter and **max_backups** will both be applied. The value ranges from **0** to **100**. If this parameter is configured, **timezone** is mandatory. This parameter and **retention_duration_days** cannot be both applied.                                                                      |
   |                         |                       |                                                                                                                                                                                                                                                                                                                                                                                                                         |
   |                         |                       | Minimum: **0**                                                                                                                                                                                                                                                                                                                                                                                                          |
   |                         |                       |                                                                                                                                                                                                                                                                                                                                                                                                                         |
   |                         |                       | Maximum: **100**                                                                                                                                                                                                                                                                                                                                                                                                        |
   +-------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | destination_project_id  | String                | ID of the replication destination project, which is mandatory for cross-region replication                                                                                                                                                                                                                                                                                                                              |
   +-------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | destination_region      | String                | Replication destination region, which is mandatory for cross-region replication. The destination region cannot be the same as the current region. The value contains 0 to 255 characters, including only letters, digits, underscores (_), and hyphens (-).                                                                                                                                                             |
   +-------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | max_backups             | Integer               | Maximum number of backups that can be automatically created for an object. The value can be -1 or 1-99999. If the value is set to -1, backups will not be cleared by the quantity of backups. If this parameter and retention_duration_days are both left blank, backups will be retained permanently. This field and retention_duration_days cannot be both set.                                                       |
   |                         |                       |                                                                                                                                                                                                                                                                                                                                                                                                                         |
   |                         |                       | Minimum: **1**                                                                                                                                                                                                                                                                                                                                                                                                          |
   |                         |                       |                                                                                                                                                                                                                                                                                                                                                                                                                         |
   |                         |                       | Maximum: **99999**                                                                                                                                                                                                                                                                                                                                                                                                      |
   |                         |                       |                                                                                                                                                                                                                                                                                                                                                                                                                         |
   |                         |                       | Default: **-1**                                                                                                                                                                                                                                                                                                                                                                                                         |
   +-------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | month_backups           | Integer               | Maximum number of monthly backups that can be retained. The latest backup of each month is saved in the long term. This parameter and **max_backups** will both be applied. The value ranges from **0** to **100**. If this parameter is configured, **timezone** is mandatory. This parameter and **retention_duration_days** cannot be both applied.                                                                  |
   |                         |                       |                                                                                                                                                                                                                                                                                                                                                                                                                         |
   |                         |                       | Minimum: **0**                                                                                                                                                                                                                                                                                                                                                                                                          |
   |                         |                       |                                                                                                                                                                                                                                                                                                                                                                                                                         |
   |                         |                       | Maximum: **100**                                                                                                                                                                                                                                                                                                                                                                                                        |
   +-------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | retention_duration_days | Integer               | Duration of retaining a backup, in days. The maximum value is **99999**. If the value is set to **-1**, backups will not be cleared by retention duration. If this parameter and **max_backups** are left blank at the same time, the backups will be retained permanently. This parameter cannot be applied together with **max_backups**, **day_backups**, **week_backups**, **month_backups**, and **year_backups**. |
   |                         |                       |                                                                                                                                                                                                                                                                                                                                                                                                                         |
   |                         |                       | Minimum: **1**                                                                                                                                                                                                                                                                                                                                                                                                          |
   |                         |                       |                                                                                                                                                                                                                                                                                                                                                                                                                         |
   |                         |                       | Maximum: **99999**                                                                                                                                                                                                                                                                                                                                                                                                      |
   |                         |                       |                                                                                                                                                                                                                                                                                                                                                                                                                         |
   |                         |                       | Default: **-1**                                                                                                                                                                                                                                                                                                                                                                                                         |
   +-------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | timezone                | String                | Time zone where the user is located. The format is UTC+01:00. If any of the parameters of yearly, monthly, weekly, or daily backup is selected, this parameter cannot be left empty.                                                                                                                                                                                                                                    |
   +-------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | week_backups            | Integer               | Maximum number of weekly backups that can be retained. The latest backup of each week is saved in the long term. This parameter and **max_backups** will both be applied. The value ranges from **0** to **100**. If this parameter is configured, **timezone** is mandatory. This parameter and **retention_duration_days** cannot be both applied.                                                                    |
   +-------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | year_backups            | Integer               | Maximum number of yearly backups that can be retained. The latest backup of each year is saved in the long term. This parameter and **max_backups** will both be applied. The value ranges from **0** to **100**. If this parameter is configured, **timezone** is mandatory. This parameter and **retention_duration_days** cannot be both applied.                                                                    |
   |                         |                       |                                                                                                                                                                                                                                                                                                                                                                                                                         |
   |                         |                       | Minimum: **0**                                                                                                                                                                                                                                                                                                                                                                                                          |
   |                         |                       |                                                                                                                                                                                                                                                                                                                                                                                                                         |
   |                         |                       | Maximum: **100**                                                                                                                                                                                                                                                                                                                                                                                                        |
   +-------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _listpolicies__response_policytriggerresp:

.. table:: **Table 7** PolicyTriggerResp

   +-----------------------+------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------+
   | Parameter             | Type                                                                                           | Description                                                                  |
   +=======================+================================================================================================+==============================================================================+
   | id                    | String                                                                                         | Scheduler ID                                                                 |
   +-----------------------+------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------+
   | name                  | String                                                                                         | Scheduler name                                                               |
   +-----------------------+------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------+
   | properties            | :ref:`PolicyTriggerPropertiesResp <listpolicies__response_policytriggerpropertiesresp>` object | Scheduler attributes                                                         |
   +-----------------------+------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------+
   | type                  | String                                                                                         | Scheduler type. Currently, only **time** (periodic scheduling) is supported. |
   |                       |                                                                                                |                                                                              |
   |                       |                                                                                                | Enumeration values:                                                          |
   |                       |                                                                                                |                                                                              |
   |                       |                                                                                                | -  **time**                                                                  |
   +-----------------------+------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------+

.. _listpolicies__response_policytriggerpropertiesresp:

.. table:: **Table 8** PolicyTriggerPropertiesResp

   +------------+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter  | Type             | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
   +============+==================+===================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
   | pattern    | Array of strings | Scheduling rule of the scheduler. A maximum of 24 rules can be configured. The scheduling rule complies with iCalendar RFC 2445, but it supports only the **FREQ**, **BYDAY**, **BYHOUR**, **BYMINUTE**, and **INTERVAL** parameters. **FREQ** can be set only to **WEEKLY** or **DAILY**. **BYDAY** can be set to **MO**, **TU**, **WE**, **TH**, **FR**, **SA**, and **SU** (seven days of a week). **BYHOUR** ranges from 0 to 23 hours. **BYMINUTE** ranges from 0 to 59 minutes. The scheduling interval cannot be less than 1 hour. A maximum of 24 time points are allowed in a day. For example, if the scheduling time is 14:00 (UTC) from Monday to Sunday, set the scheduling rule as follows: **FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR,SA,SU;BYHOUR=14;BYMINUTE=00**. If the scheduling time is 14:00 (UTC+8) every day, set the scheduling rule as follows: **FREQ=DAILY;INTERVAL=1;BYHOUR=6;BYMINUTE=00** |
   +------------+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | start_time | String           | Start time of the scheduler, for example, **2020-01-08 09:59:49**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
   +------------+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _listpolicies__response_policyassociatevault:

.. table:: **Table 9** PolicyAssociateVault

   ==================== ====== =================================
   Parameter            Type   Description
   ==================== ====== =================================
   destination_vault_id String ID of the associated remote vault
   vault_id             String Vault ID
   ==================== ====== =================================

Example Requests
----------------

.. code-block:: text

   GET  https://{endpoint}/v3/{project_id}/policies

Example Responses
-----------------

**Status code: 200**

OK

.. code-block::

   {
     "policies" : [ {
       "name" : "policy001",
       "associated_vaults" : [ ],
       "enabled" : true,
       "trigger" : {
         "properties" : {
           "pattern" : [ "FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR,SA,SU;BYHOUR=14;BYMINUTE=00" ],
           "start_time" : "2019-05-08T06:57:05.000+00:00"
         },
         "type" : "time",
         "id" : "d67269a6-5369-42d7-8150-5254bd446328",
         "name" : "default"
       },
       "operation_definition" : {
         "retention_duration_days" : 1,
         "year_backups" : 0,
         "day_backups" : 0,
         "month_backups" : 0,
         "week_backups" : 0,
         "timezone" : "UTC+01:00"
       },
       "operation_type" : "backup",
       "id" : "cbb3ce6f-3332-4e7c-b98e-77290d8471ff"
     } ],
     "count" : 10
   }

Status Codes
------------

=========== ===========
Status Code Description
=========== ===========
200         OK
=========== ===========

Error Codes
-----------

See :ref:`Error Codes <errorcode>`.
