:original_name: cbr_03_0104.html

.. _cbr_03_0104:

(Optional) Migrating Resources from CSBS/VBS
============================================

Context
-------

The cloud platform has launched the next-generation backup service, CBR. If you have backup resources in CSBS or VBS but want to switch to CBR for the management of these historical backup resources, you can migrate them to CBR in a few clicks.

If you have never used CSBS or VBS, or do not need the historical backups anymore, skip this section.

Migration Rules
---------------

During migration, the system will automatically create vaults based on your historical resources.

#. If servers or disks have been associated with a backup policy and have been backed up, during the migration, the system will create a vault with the same name (up to 64 characters) as the policy name, regardless of whether the policy is enabled. After the vault is created, the policy will be applied to the vault.
#. If servers or disks have been associated with a backup policy but no backup has been generated, during the migration, the system will create a vault only when the policy is enabled. After the vault is created, the policy will be applied to the vault. The rule for naming the vault is the same as that in the preceding rule.
#. If servers or disks have been applied with a backup or replication policy but no backup or replica has been generated, and the policy is not enabled, then only the policy will be migrated.
#. The system will migrate backup and replication policies regardless of whether they are associated with servers or disks.
#. Generated backup replicas will be stored in a replication vault named **default**.
#. Other backups, such as manual backups, will be stored in a server backup vault named **default**. Different vaults will be automatically created based on different types of resources. For example, the system will create a disk backup vault during the migration of disk backups.
#. After resources are migrated, backups created using CBR will also be displayed in VBS Console, but you will be billed only once.

   .. note::

      To delete backups from VBS Console, find these backups in CBR and delete them. Then, the backups will also be automatically deleted from VBS Console.

#. If an image has been created using a backup before the migration and a tag has been added to the image, the backup migration may fail. In this case, go to IMS Console, delete the tag of the image, and then perform the migration again. After the migration is complete, re-add the tag if needed.

Base on the preceding rules, the capacity of each vault created by the system is predefined as 1.2 times of the total backup size.

For example, a user has a 100 GB ECS and a 50 GB ECS. The used storage capacity of the two ECSs is 20 GB and 10 GB, respectively. The user manually has backed up the two entire ECSs using cloud server backup. During migration, the capacity of the vault automatically created will be 1.2 times of the total backup size. In this example, the total backup size multiplied by 1.2 is 36 GB. So the system will automatically create a 36 GB vault.

Constraints
-----------

-  The vaults you have cannot be used for migration. The system will automatically migrate resources to the vaults created by the system.
-  Backup resources of one account need to be migrated only once.
-  After resources are migrated, disk backups and server backups will be automatically stored in CBR vaults. No further operations are required.

Procedure
---------

#. Log in to CBR Console.

   a. Log in to the management console.
   b. Click |image1| in the upper left corner and select your region and project.
   c. Choose **Storage** > **Cloud Backup and Recovery**. Select a backup tab from the left navigation pane.

#. Click **Migrate to CBR** in the upper right corner. Read the content in the displayed dialog box and click **OK**. See :ref:`Figure 1 <cbr_03_0104__fig1730015415381>`.

   .. _cbr_03_0104__fig1730015415381:

   **Figure 1** Migrating resources to CBR

   |image2|

#. The system will automatically migrate resources. After the migration, a vault named **default** will be created and a message will be displayed in the upper part of the page indicating that the migration is successful.

FAQ
---

#. Why Are CBR Backups Displayed on VBS Console?

   If you have migrated data from CSBS and VBS to CBR, and created a backup on CBR Console, the same backup record will be generated on VBS Console. This is due to an underlying mechanism. VBS Console displays all backups generated by CBR, CSBS, and VBS.

#. How Do I Delete Backups from VBS Console?

   After you have migrated data from CSBS and VBS to CBR, backups displayed in VBS Console cannot be deleted alone. Find these backups in CBR and delete them. Then, the backups will be also deleted from VBS Console.

#. What Are the Differences Between CBR, CSBS, and VBS?

   CBR integrates CSBS and VBS. In addition, CBR supports SFS Turbo backup.

#. What Can I Do If a Message Is Displayed Indicating that a Resource Has Been Bound with CSBS or VBS?

   Choose **Cloud Server Backup Service** or **Volume Backup Service** from the service list. On the corresponding service console, check whether there are resources bound with policies on the **Policies** tab. If so, unbind the resources from the policy and go to CBR Console to associate the resources with a vault.

.. |image1| image:: /_static/images/en-us_image_0159365094.png
.. |image2| image:: /_static/images/en-us_image_0000001293014297.png
